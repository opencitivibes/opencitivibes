# Semgrep findings to ignore (false positives and accepted risks)
# Each entry requires justification and reviewer approval
#
# This file documents accepted security risks that have been
# reviewed and approved by the security team.
#
# Format:
#   - rule_id: <semgrep-rule-id>
#     path: <file-path-pattern>
#     reason: "<justification>"
#     approved_by: "<approver>"
#     expires: "<YYYY-MM-DD>"
#     ticket: "<tracking-ticket-id>"

ignored_findings:

  # Example suppression (commented out)
  # - rule_id: jwt-weak-algorithm
  #   path: backend/authentication/auth.py
  #   reason: "HS256 is acceptable for internal-only API. Migration to RS256 planned."
  #   approved_by: "security-team"
  #   expires: "2025-06-01"
  #   ticket: "SEC-123"

  # Accepted risks for development/testing code
  - rule_id: debug-mode-enabled
    path: "*/tests/*"
    reason: "Debug mode acceptable in test files"
    approved_by: "dev-team"
    expires: "2026-12-31"

  - rule_id: hardcoded-localhost-url
    path: "*/tests/*"
    reason: "Localhost URLs expected in test configuration"
    approved_by: "dev-team"
    expires: "2026-12-31"

  # Pentest scripts are allowed to use dangerous patterns
  - rule_id: subprocess-shell-injection
    path: "pentest/scripts/*"
    reason: "Pentest scripts intentionally use shell commands"
    approved_by: "security-team"
    expires: "2026-12-31"

  - rule_id: eval-usage
    path: "pentest/scripts/*"
    reason: "Pentest scripts may use dynamic code execution"
    approved_by: "security-team"
    expires: "2026-12-31"

# Suppression workflow documentation:
#
# 1. When a finding is identified as a false positive:
#    - Create a ticket documenting the finding
#    - Add entry to this file with justification
#    - Get approval from security team
#    - Set expiration date (max 1 year)
#
# 2. When a finding is an accepted risk:
#    - Document the risk in the ticket
#    - Get approval from both security and project lead
#    - Add compensating controls if possible
#    - Set shorter expiration for high-severity findings
#
# 3. Review process:
#    - All suppressions reviewed quarterly
#    - Expired suppressions are automatically reactivated
#    - High-severity suppressions reviewed monthly
#
# 4. CI integration:
#    - Semgrep reads this file via --config semgrep-ignore.yaml
#    - Findings matching entries are downgraded to INFO
#    - Expired entries are reported as warnings
